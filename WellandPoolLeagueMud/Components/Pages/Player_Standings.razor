@page "/player_standings"
@using WellandPoolLeagueMud.Data.Services
@using WellandPoolLeagueMud.Data.ViewModels
@using WellandPoolLeagueMud.Components.Buttons
@using MudBlazor
@using System.Linq
@attribute [StreamRendering]

<PageTitle>Player Standings</PageTitle>

@if (playerData is not null)
{
    <MudDataGrid TItem="PlayerViewModel"
                 Items="@playerData"
                 Filterable="true"
                 Sortable="true"
                 Striped="true"
                 Hover="true"
                 Bordered="true"
                 Class="pb-2">

        <ToolBarContent>
            <MudText Typo="Typo.h6">Player Standings</MudText>
            <MudSpacer />
            <MudTextField T="string" Placeholder="Search" Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium" Class="mt-0" />
        </ToolBarContent>
        <Columns>
            <PropertyColumn Property="x => x.TeamName" Title="Team" Filterable="true" />
            <PropertyColumn Property="x => x.FirstName" Title="First Name" />
            <PropertyColumn Property="x => x.LastName" Title="Last Name" />
            <PropertyColumn Property="x => x.GamesPlayed" Title="Games Played" />
            <PropertyColumn Property="x => x.FramesWon" Title="Frames Won" />
            <PropertyColumn Property="x => x.FramesLost" Title="Frames Lost" />
            <PropertyColumn Property="x => x.Average" Title="Average" Format="P2" />
        </Columns>
        <PagerContent>
            <MudDataGridPager T="PlayerViewModel" />
        </PagerContent>
        <NoRecordsContent>
            <div class="box">
                No Player Stats Found!
            </div>
        </NoRecordsContent>
    </MudDataGrid>
}

<ScrollToTopButton />

@code {
    [Inject] private PDataService pDataService { get; set; } = default!;

    private List<PlayerViewModel>? playerData;

    protected override async Task OnInitializedAsync()
    {
        playerData = await pDataService.GetFullPlayerDataAsync();
    }
}